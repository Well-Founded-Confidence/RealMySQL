[4.4.1 에러 로그 파일](#441-에러-로그-파일)
- [4.4.1.1 MySQL이 시작하는 과정과 관련된 정보설 및 에러 메시지](#4411-mysql이-시작하는-과정과-관련된-정보설-및-에러-메시지)
- [4.4.1.2 마지막으로 종료할 때 비정상적으로 종료된 경우 나타나는 InnoDB의 트랜잭션 복구 메시지](#4412-마지막으로-종료할-때-비정상적으로-종료된-경우-나타나는-innodb의-트랜잭션-복구-메시지)
- [4.4.1.3 쿼리 처리 도중에 발생하는 문제에 대한 에러 메시지](#4413-쿼리-처리-도중에-발생하는-문제에-대한-에러-메시지)
- [4.4.1.4 비정상적으로 종료된 커넥션 메시지 (Aborted connection)](#4414-비정상적으로-종료된-커넥션-메시지-aborted-connection)
- [4.4.1.5 InnoDB의 모니터링 또는 상태 조회 명령 (SHOW ENGINE INNODB STATUS 같은)의 결과 메시지](#4415-innodb의-모니터링-또는-상태-조회-명령-show-engine-innodb-status-같은의-결과-메시지)
- [4.4.1.6 MySQL의 종료 메시지](#4416-mysql의-종료-메시지)

[4.4.2 제너럴 쿼리 로그 파일 (제너럴 로그 파일, General log)](#442-제너럴-쿼리-로그-파일-제너럴-로그-파일-general-log)

[4.4.3 슬로우 쿼리 로그](#443-슬로우-쿼리-로그)
- [4.4.3.1 슬로우 쿼리 통계](#4431-슬로우-쿼리-통계)
- [4.4.3.2 실행 빈도 및 누적 실행 시간순 랭킹](#4432-실행-빈도-및-누적-실행-시간순-랭킹)
- [4.4.3.3 쿼리별 실행 횟수 및 누적 실행 시간 상세 정보](#4433-쿼리별-실행-횟수-및-누적-실행-시간-상세-정보)

# 4.4.1 에러 로그 파일
> MySQL 실행 도중 발생하는 에러나 경고메시지가 출력되는 로그 파일
- MySQL 설정 파일 (my.cnf)에서 `log_error` 라는 이름의 파라미터로 정의된 경로에 생성된다.
- MySQL 설정 파일에 별도로 정의되지 않은 경우에는 데이터 디렉터리에 `.err` 파일이 생성된다.

## 4.4.1.1 MySQL이 시작하는 과정과 관련된 정보설 및 에러 메시지
- MySQL의 설정 파일을 변경하거나 데이터베이스가 비정상적으로 종료된 이후 다시 시작하는 경우에는 반드시 MySQL 에러 로그 파일을 통해 설정된 변수의 이름이나 값이 명확하게 설정되고 의도한 대로 적용됐는지 확인해야 한다.

## 4.4.1.2 마지막으로 종료할 때 비정상적으로 종료된 경우 나타나는 InnoDB의 트랜잭션 복구 메시지
- MySQL 서버가 비정상적 또는 강제적으로 종료될 경우 다시 시작할 때 완료되지 못한 트랜잭션을 정리하고 디스크에 기록되지 못한 데이터를 다시 기록하는 작업을 한다.
- 위 과정에서 문제가 발생해서 복구되지 못하면 에러메시지를 출력하고 MySQL을 종료한다.

## 4.4.1.3 쿼리 처리 도중에 발생하는 문제에 대한 에러 메시지
- 사전 예방이 어려우며, 주기적으로 에러 로그 파일을 검토하는 과정에서 알 수 있다.

## 4.4.1.4 비정상적으로 종료된 커넥션 메시지 (Aborted connection)
- 클라이언트측 프로그램이 비정상적으로 종료된 경우 MySQL 서버의 에러 로그 파일에 메시지가 기록된다.
- 이런 메시지가 많이 기록된다면 애플리케이션의 커넥션 종료 로직을 검토할 필요가 있다.

## 4.4.1.5 InnoDB의 모니터링 또는 상태 조회 명령 (SHOW ENGINE INNODB STATUS 같은)의 결과 메시지
- InnoDB의 테이블 모니터링이나 락 모니터링, InnoDB의 엔진 상태를 조회하는 명령은 상대적으로 큰 메시지를 에러 로그 파일에 기록한다.
- 모니터링을 활성화 상태로 유지하는 경우 에러 로그 파일이 커져서 파일 시스템의 공간을 다 사용할 수도 있다.
- 모니터링을 사용한 이후에는 모니터링을 비활성화 상태로 변경해서 에러 로그 파일이 커지지 않도록 한다.

## 4.4.1.6 MySQL의 종료 메시지
- 에러 로그 파일에서 MySQL이 마지막으로 종료되면서 출력한 메시지를 확인하여 원인을 파악한다.
    - 누군가가 종료시켰을 경우 `Received SHUTDOWN from user ...` 라는 메시지가 뜬다.
    - 아무런 종료 관련 메시지가 없거나 스택 트레이스와 같은 내용이 출력되는 경우 MySQL 서버가 `Segmentation fault`로 비정상적으로 종료된 것으로 판단할 수 있다.
        - 스택 트레이스의 내용을 참조해서 MySQL 버전 업그레이드 or 회피책을 찾는 것이 방법이다.

# 4.4.2 제너럴 쿼리 로그 파일 (제너럴 로그 파일, General log)
- MySQL 서버에서 실행되는 쿼리로 어떤 것들이 있는지 전체 목록을 확인한다.
- 쿼리 로그를 활성화해서 쿼리를 쿼리 로그 파일로 기록하게 한 다음, 그 파일을 검토한다.
- 슬로우 쿼리 로그와는 다르게 쿼리 요청을 받으면 바로 기록하므로 에러가 발생해도 로그 파일에 기록된다.

# 4.4.3 슬로우 쿼리 로그
- MySQL의 쿼리 튜닝
    - 서비스가 적용되기 전에 전체적으로 튜닝
        - 모든 쿼리가 검토해야할 대상이므로 모두 튜닝
    - 서비스 운영중에 MySQL 서버의 전체적인 성능 저하를 검사하거나 정기적인 점검을 위한 튜닝
        - 어떤 쿼리가 문제의 쿼리인지 판단하기 어려움
        - 슬로우 쿼리 로그를 통해 파악한다.
- 쿼리의 실제 소요된 시간을 기준으로 슬로우 쿼리 로그에 기록할지 여부를 판단한다.
    - 반드시 쿼리가 정상적으로 실행이 완료돼야 기록될 수 있다.
    - 정상적으로 실행이 완료되었고, `long_query_time`에 정의된 시간보다 많이 걸린 쿼리가 기록된다.

## 4.4.3.1 슬로우 쿼리 통계
- 분석 결과의 최상단에 표시되며, 모든 쿼리를 대상으로 슬로우 쿼리 로그의 실행 시간, 잠금 대기 시간 등에 대해 평균, 최소, 최대 값을 표시한다.

## 4.4.3.2 실행 빈도 및 누적 실행 시간순 랭킹
- 각 쿼리별로 응답 시간과 실행 횟수를 보여준다.
- `pt-query-digest` 명령을 실행해서 `--order-by` 옵션으로 정렬 순서를 변경할 수 있다.

## 4.4.3.3 쿼리별 실행 횟수 및 누적 실행 시간 상세 정보
- QueryId별 쿼리를 쿼리 랭킹에 표시된 순서대로 자세한 내용을 보여준다.
- 쿼리가 얼마나 실행됐는지, 쿼리의 응답 시간에 대한 히스토그램 같은 상세 내용을 보여준다.
