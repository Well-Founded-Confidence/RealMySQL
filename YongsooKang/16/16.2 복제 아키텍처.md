# 복제 아키텍처
- MySQL 서버의 모든 변경사항은 바이너리 로그에 기록됨
  - DB, 테이블, 데이터의 변경 모두 저장됨
  - MySQL의 복제는 바이너리 로그를 기반으로 구현됨
    - 소스 서버에서 생성된 바이너리 로그가 레플리카 서버로 전송
    - 레플리카 서버에서는 해당 내용을 로컬 디스크에 저장한 뒤 자신이 가진 데이터에 반영함
      - 로컬 디스크에 저장한 파일을 릴레이 로그라고 함
- MySQL의 복제는 3개의 스레드에 의해 작동함
  - 하나는 소스 서버에 존재
    - 바이너리 로그 덤프 스레드
  - 나머지 두개는 레플리카 서버에 존재
    - 레플리케이션 I/O 스레드
    - 레클리케이션 SQL 스레드
    - 두 스레드는 서로 독립적으로 동작하여 하나의 스레드가 느려지더라도 영향을 받지 않음
  - 소스 서버의 스레드가 문제가 생겨서 레플리카 서버의 I/O 스레드가 정상적으로 동작하지 않으면 복제 작업은 에러를 발생시키고 중단한다.
- 복제 시작 시 레플리카 서버가 생성하고 관리하는 데이터
  - 릴레이 로그
    - 레플리케이션 I/O 스레드에 의해 작성
    - 소스 서버에서 읽은 데이터가 저장됨
  - 커넥션 메타데이터
    - 레플리케이션 I/O 스레드에서 소스 서버에 연결할 때 사용하는 DB 계정정보 및 현재 읽고 있는 소스 서버의 바이너리 파일명과 파일 내 위치 값 등이 담겨있음
    - 기본적으로 `mysql.slave_master_info` 테이블에 저장됨
  - 어플라이어 메타데이터
    - 레플리케이션 SQL 스레드에서 릴레이 로그에 저장된 소스 서버의 이벤트들을 레플리카 서버에 적용하는 컴포넌트
    - 최근에 적용된 이벤트에 대한 정보들이 담겨있음
    - 기본적으로 `mysql.slave_relay_log_info` 테이블에 저장됨
