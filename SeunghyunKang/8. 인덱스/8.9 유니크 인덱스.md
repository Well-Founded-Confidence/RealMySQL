# 8.9 유니크 인덱스

유니크는 인덱스 보다 제약 조건에 가깝다고 볼 수 있다.

## 8.9.1 유니크 인덱스와 일반 세컨더리 인덱스의 비교

구조상 아무런 차이점이 없지만 읽기 쓰기 성능 관점에서 살펴보자

### 8.9.1.1 인덱스 읽기

세컨더리 인덱스도 CPU에서 읽어오기에 유니크와 세컨더리는 사실 성능상 차이가 없다.

**세컨더리 인덱스는 중복된 값이 허용되기에 읽을 레코드가 많아서 느린거**지 인덱스 자체의 특성때문에 느리진 않다.

### 8.9.1.2 인덱스 쓰기

유니크 인덱스는 중복 값이 있는지 없는지 체크하는 과정이 한 단계 더 필요하다.

그래서 세컨더리보다 느리다.

그런데 유니트 인덱스에서 중복 값을 체크할 때는 읽기 잠금을 사용하고, 쓰기를 할 때는 쓰기 잠금을 사용하는데 이 과정에서 데드락이 아주 빈번히 발생한다.

또한 InnoDB에서는 인덱스 키의 저장을 버퍼링하기 위해 체인지 버퍼가 사용된다. 그래서 저장이나 변경 작업이 상당히 빨리 처리되지만, 안타깝게도 유니크 인덱스는 반드시 중복 체크를 해야 하므로 작업 자체를 버퍼링하지 못한다.

이 때문에 유니크 인덱스는 일반 세컨더리 인덱스보다 변경 작업이 더 느리게 작동한다.

## 8.9.2 유니크 인덱스 사용 시 주의사항

꼭 필요한 경우라면 유니크 인덱스 생성은 당옇나다. 하지만 더 성능이 좋아질 것으로 생각하고 불필요하게 생성하는 것은 좋지 않다.

아래와 같은 상황은 피하자.

- 하나의 컬럼에 일반 인덱스와 유니크 인덱스 설정
- 하나의 컬럼에 PK와 유니크 인덱스 설정
